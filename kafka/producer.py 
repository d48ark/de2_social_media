from kafka import KafkaProducer
import json
import time

# Kafka configuration
KAFKA_TOPIC = "social-media"
KAFKA_SERVER = "localhost:9092"

# Initialize producer
producer = KafkaProducer(
    bootstrap_servers=KAFKA_SERVER,
    value_serializer=lambda v: json.dumps(v).encode("utf-8")
)

# Load sample data
with open("sample_data.json", "r") as f:
    tweets = json.load(f)

# Publish each tweet with a delay
for tweet in tweets:
    producer.send(KAFKA_TOPIC, tweet)
    print(f"Sent tweet: {tweet}")
    time.sleep(1)

producer.flush()
